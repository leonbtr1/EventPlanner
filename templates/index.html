{% extends 'base.html' %}
{% block title %}Events · EventPlanner{% endblock %}
{% block content %}
  <h2>Available Events</h2>
  <div class="cards">
    {% if events %}
      {% for e in events %}
        <article class="card">
          <header>
            <h3>{{ e.name }}</h3>
            <p class="muted">{{ e.date.strftime('%Y-%m-%d') }}</p>
          </header>
          {% if e.description %}
            <p>{{ e.description }}</p>
          {% endif %}
          <p>
            Capacity: <strong>{{ e.capacity }}</strong> ·
            Registered: <strong>{{ e.registrations|length }}</strong> ·
            Seats left: <strong>{{ e.capacity - (e.registrations|length) }}</strong>
          </p>

          <form method="post" action="{{ url_for('register') }}" class="form-inline">
            <input type="hidden" name="event_id" value="{{ e.id }}" />
            <input required type="text" name="name" placeholder="Your name" />
            <input required type="email" name="email" placeholder="Your email" />
            <button type="submit" {% if e.registrations|length >= e.capacity %}disabled{% endif %}>
              {% if e.registrations|length >= e.capacity %}Full{% else %}Register{% endif %}
            </button>
          </form>
        </article>
      {% endfor %}
    {% else %}
      <p>No events yet. Check back later.</p>
    {% endif %}
  </div>
{% endblock %}