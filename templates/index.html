{% extends 'base.html' %}
{% block title %}Događaji · EventPlanner{% endblock %}
{% block content %}
  <h2>Dostupni događaji</h2>

  <div class="cards">
    {% if events %}
      {% for e in events %}
        <article class="card">
          
          <header>
            <h3>{{ e.name }}</h3>
            <p class="mute">{{ e.date.strftime('%Y-%m-%d') }}</p>
          </header>

          {% if e.description %}
            <p>{{ e.description }}</p>
          {% endif %}

          <p>
            Kapacitet: <strong>{{ e.capacity }}</strong> ·
            Prijavljeno: <strong>{{ e.registrations|length }}</strong> ·
            Slobodna mjesta: <strong>{{ e.capacity - (e.registrations|length) }}</strong>
          </p>

          <form method="post" action="{{ url_for('register') }}" class="form-inline">
            
            <input type="hidden" name="event_id" value="{{ e.id }}" />
            <input required type="text"  name="name"  placeholder="Ime" />
            <input required type="email" name="email" placeholder="E-mail" />
            
            <button type="submit" {% if e.registrations|length >= e.capacity %}disabled{% endif %}>
              {% if e.registrations|length >= e.capacity %}Popunjeno{% else %}Prijavi se{% endif %}
            </button>
          </form>
        </article>
      {% endfor %}
    
    {% else %}
      <p>Nema događaja. Provjerite kasnije.</p>
    
    {% endif %}
  </div>
{% endblock %}
